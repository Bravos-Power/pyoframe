# Migrate to v0.3.0

v0.3.0 comes with several improvements including:

- Support for the [Ipopt](https://coin-or.github.io/Ipopt/) solver (thanks Eduardo Salazar!)
- A more intuitive API (see below)
- Improved documentation
- Much more readable outputs when printing Pyoframe objects to the console
- And more! (see [GitHub releases](https://github.com/Bravos-Power/pyoframe/releases))

Unfortunately, these improvements involve some breaking changes. This page will guide you in updating your code.

## 1. Fix imports

Pyoframe's subpackages are no longer part of the public API meaning that `import pyoframe.constants` will no longer work. Instead, you should simply use `import pyoframe as pf` or `from pyoframe import Model, Variable, ...`. See the [list of available classes and functions](/pyoframe/reference/) when importing pyoframe.

## 2. Migrate `pf.Model(...)`

`name` is now a _named-only_ optional parameter of `Model`:

```python
import pyoframe as pf

# pf.Model("my-model")  # invalid in v0.3.0
pf.Model(name="my-model")  # valid
```

`solver` is now the first argument to `Model` so you can simplify your code (optional):

```python
pf.Model(solver="gurobi")  # valid
pf.Model("gurobi")  # also valid!
```

`use_var_names` has been renamed to `solver_uses_variable_names` (to avoid confusion with the new option `print_uses_variable_names`)

```python
# pf.Model(use_var_names=True)  # invalid in v0.3.0
pf.Model(solver_uses_variable_names=True)  # valid
```

See the full [`Model` signature][pyoframe.Model] for details.

## 3. Migrate `pf.sum` and `pf.sum_by`

`pf.sum` and `pf.sum_by` are deprecated. Instead, you should call `.sum` and `.sum_by` directly on Pyoframe objects:

```python
import pyoframe as pf

cities = pf.Set(city=["a", "b", "c"])
day_of_week = pf.Set(day=range(7))
m = pf.Model()
m.Spending = pf.Variable(cities * day_of_week)


pf.sum(m.Spending)  # deprecated
m.Spending.sum()  # correct usage in v0.3.0

total_spending_by_city = pf.sum("day", m.Spending)  # deprecated
total_spending_by_city = m.Spending.sum("day")  # correct usage in v0.3.0

# alternatively using .sum_by
total_spending_by_city = pf.sum_by("city", m.Spending)  # deprecated
total_spending_by_city = m.Spending.sum_by("city")  # correct usage in v0.3.0
```

If you were using `pf.sum` or `pf.sum_by` on non-Pyoframe objects you'll need to convert the objects to Pyoframe first with `.to_expr()` (or, preferably, apply the summation natively in Pandas or Polars).

## Other breaking changes

- If for some weird reason you try to access `model.objective` before having defined your objective, an error will be raised (previously `None` was returned). See [API documentation][pyoframe.Model.objective].

- `ModelElement.unmatched_strategy`, `ModelElement.allowed_new_dims`, `ModelElement.dimensions_unsafe` no longer exist. These were internal variables that should never have been part of the public API. (If you need to access these variables, they are available with an underscore, e.g. `ModelElement._unmatched_strategy`.)
